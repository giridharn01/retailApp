"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[343],{343:(e,s,t)=>{t.r(s),t.d(s,{default:()=>i});var n=t(43),a=t(45),r=t(536),l=t(579);const i=()=>{const[e,s]=(0,n.useState)([]),[t,i]=(0,n.useState)(!0),[d,c]=(0,n.useState)(null),[o,m]=(0,n.useState)("all"),[x,h]=(0,n.useState)([]),[u,p]=(0,n.useState)(!1),j=(0,a.zy)();(0,n.useEffect)(()=>{var e;g(),null!==(e=j.state)&&void 0!==e&&e.order&&c(j.state.order)},[j.state]),(0,n.useEffect)(()=>{console.log("OrdersPage setting up polling for real-time updates");const e=setInterval(()=>{g(!0)},15e3),s=()=>{g(!0)};return window.addEventListener("focus",s),()=>{clearInterval(e),window.removeEventListener("focus",s)}},[]);const g=async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{t||i(!0);const n=(await(0,r.A)("/orders")).data;if(t&&e.length>0){const s=[];n.forEach(t=>{const n=e.find(e=>e._id===t._id);n&&n.status!==t.status&&s.push({orderNumber:t.orderNumber,oldStatus:n.status,newStatus:t.status})}),s.length>0&&(h(s),p(!0),setTimeout(()=>p(!1),5e3))}s(n)}catch(n){console.error("Error fetching orders:",n)}finally{t||i(!1)}},v=e=>{switch(e){case"ready-for-pickup":return"bg-green-100 text-green-800";case"in-progress":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}},f=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=e=>{if(e.statusHistory&&e.statusHistory.length>0){const s=e.statusHistory[e.statusHistory.length-1],t=new Date(s.timestamp);return new Date-t<3e5}return!1},b=e.filter(e=>"all"===o||e.status===o);return t?(0,l.jsx)("div",{className:"flex justify-center items-center min-h-[60vh]",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,l.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[u&&(0,l.jsxs)("div",{className:"fixed top-4 right-4 z-50 bg-blue-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-3 animate-pulse",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Order status updated!"}),(0,l.jsx)("div",{className:"text-sm opacity-90",children:x.map((e,s)=>(0,l.jsxs)("div",{children:["Order #",e.orderNumber,": ",e.oldStatus," \u2192 ",e.newStatus]},s))})]}),(0,l.jsx)("button",{onClick:()=>p(!1),className:"ml-2 text-white hover:text-gray-200",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"My Orders"}),(0,l.jsx)("div",{className:"flex items-center space-x-4",children:(0,l.jsxs)("select",{value:o,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"all",children:"All Orders"}),(0,l.jsx)("option",{value:"pending",children:"Pending"}),(0,l.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,l.jsx)("option",{value:"ready-for-pickup",children:"Ready for Pickup"}),(0,l.jsx)("option",{value:"cancelled",children:"Cancelled"})]})})]}),0===b.length?(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"\ud83d\udce6"}),(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No orders found"}),(0,l.jsx)("p",{className:"text-gray-600",children:"You haven't placed any orders yet."})]}):(0,l.jsx)("div",{className:"space-y-6",children:b.map(e=>{var s,t,n,a;return(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden ".concat(N(e)?"ring-2 ring-blue-500 ring-opacity-50":""),children:[(0,l.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Order #",e.orderNumber]}),(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(v(e.status)),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),N(e)&&(0,l.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:[(0,l.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Updated"]})]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Placed on ",f(e.createdAt)]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Total: \u20b9",e.totalAmount]})]}),(0,l.jsx)("div",{className:"flex items-center space-x-2",children:(0,l.jsxs)("button",{onClick:()=>c((null===d||void 0===d?void 0:d._id)===e._id?null:e),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",children:[(0,l.jsx)("span",{children:"Details"}),(0,l.jsx)("svg",{className:"ml-1 w-4 h-4 transition-transform ".concat((null===d||void 0===d?void 0:d._id)===e._id?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})}),(null===d||void 0===d?void 0:d._id)===e._id&&(0,l.jsx)("div",{className:"p-6 bg-gray-50",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-lg font-semibold mb-4",children:"Order Items"}),(0,l.jsx)("div",{className:"space-y-3",children:e.items.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg",children:[(0,l.jsx)("img",{src:e.product.image||"/default-product.jpg",alt:e.product.name,className:"w-12 h-12 object-cover rounded"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"font-medium",children:e.product.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Qty: ",e.quantity," \xd7 \u20b9",e.price]})]}),(0,l.jsxs)("p",{className:"font-semibold",children:["\u20b9",e.subtotal]})]},s))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-lg font-semibold mb-4",children:"Order Tracking"}),(0,l.jsx)("div",{className:"space-y-4",children:e.statusHistory.map((s,t)=>(0,l.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,l.jsxs)("div",{className:"flex-shrink-0",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-blue-600 rounded-full"}),t<e.statusHistory.length-1&&(0,l.jsx)("div",{className:"w-0.5 h-8 bg-gray-300 mx-auto mt-1"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"flex items-center space-x-2 mb-1",children:(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(v(s.status)),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:f(s.timestamp)}),s.note&&(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:s.note})]})]},t))}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h5",{className:"font-semibold mb-2",children:"Shipping Address"}),(0,l.jsxs)("div",{className:"bg-white p-3 rounded-lg text-sm",children:[(0,l.jsx)("p",{className:"font-medium",children:e.shippingAddress.name}),(0,l.jsx)("p",{children:e.shippingAddress.street}),(0,l.jsxs)("p",{children:[e.shippingAddress.city,", ",e.shippingAddress.state," ",e.shippingAddress.zipCode]}),(0,l.jsx)("p",{children:e.shippingAddress.country}),(0,l.jsxs)("p",{className:"mt-1",children:["\ud83d\udcde ",e.shippingAddress.phone]})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h5",{className:"font-semibold mb-2",children:"Payment Information"}),(0,l.jsxs)("div",{className:"bg-white p-3 rounded-lg text-sm",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Method:"})," ",(null===(s=e.payment)||void 0===s||null===(t=s.method)||void 0===t?void 0:t.toUpperCase())||"Not set"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Status:"})," ",(null===(n=e.payment)||void 0===n?void 0:n.status)||"Not set"]}),(null===(a=e.payment)||void 0===a?void 0:a.transactionId)&&(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"font-medium",children:"Transaction ID:"})," ",e.payment.transactionId]})]})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h5",{className:"font-semibold mb-2",children:"Order Summary"}),(0,l.jsxs)("div",{className:"bg-white p-3 rounded-lg text-sm space-y-1",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"Subtotal:"}),(0,l.jsxs)("span",{children:["\u20b9",e.subtotal]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"Tax:"}),(0,l.jsxs)("span",{children:["\u20b9",e.tax]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"Shipping:"}),(0,l.jsx)("span",{children:0===e.shippingCost?"Free":"\u20b9".concat(e.shippingCost)})]}),(0,l.jsxs)("div",{className:"border-t pt-1 flex justify-between font-semibold",children:[(0,l.jsx)("span",{children:"Total:"}),(0,l.jsxs)("span",{children:["\u20b9",e.totalAmount]})]})]})]})]})]})})]},e._id)})})]})}}}]);
//# sourceMappingURL=343.cac611bb.chunk.js.map