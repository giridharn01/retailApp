"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[416],{416:(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var l=t(555),a=t(43),r=t(536),n=t(579);const i=[{value:"pending",label:"Pending"},{value:"in-progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}],c=a.memo(()=>{const[e,s]=(0,a.useState)([]),[t,c]=(0,a.useState)(!0),[d,o]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),[u,h]=(0,a.useState)("all"),[p,g]=(0,a.useState)(!1),[b,f]=(0,a.useState)(null),j=(0,a.useRef)({}),[y,v]=(0,a.useState)({}),[N,w]=(0,a.useState)({}),k=(0,a.useCallback)(async()=>{try{c(!0);const e=await(0,r.A)("/service-requests");s(e.data||[])}catch(e){o(e.message)}finally{c(!1)}},[]);(0,a.useEffect)(()=>{k()},[k]),(0,a.useEffect)(()=>{function e(e){null!==b&&j.current[b]&&!j.current[b].contains(e.target)&&f(null)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[b]);const C=(0,a.useCallback)(async(e,t)=>{try{v(s=>(0,l.A)((0,l.A)({},s),{},{[e]:!0})),s(s=>s.map(s=>s._id===e?(0,l.A)((0,l.A)({},s),{},{status:t}):s)),await(0,r.A)("/service-requests/".concat(e),"PUT",{status:t}),await new Promise(e=>setTimeout(e,500)),w(s=>(0,l.A)((0,l.A)({},s),{},{[e]:!0})),setTimeout(()=>{w(s=>(0,l.A)((0,l.A)({},s),{},{[e]:!1}))},2e3)}catch(a){o(a.message),await k()}finally{v(s=>(0,l.A)((0,l.A)({},s),{},{[e]:!1}))}},[k]),S=(0,a.useCallback)(async e=>{if(window.confirm("Are you sure you want to delete this request?"))try{await(0,r.A)("/service-requests/".concat(e),"DELETE"),s(s=>s.filter(s=>s._id!==e))}catch(t){o(t.message)}},[]),A=e.filter(e=>"all"===u||e.status===u),_={total:e.length,pending:e.filter(e=>"pending"===e.status).length,inProgress:e.filter(e=>"in-progress"===e.status).length,completed:e.filter(e=>"completed"===e.status).length,cancelled:e.filter(e=>"cancelled"===e.status).length,byServiceType:e.reduce((e,s)=>(e[s.serviceType]=(e[s.serviceType]||0)+1,e),{})},L=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"in-progress":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return t?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:[(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Service Request Management"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Total Requests"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:_.total})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Pending"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-yellow-600",children:_.pending})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"In Progress"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:_.inProgress})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Completed"}),(0,n.jsx)("p",{className:"text-3xl font-bold text-green-600",children:_.completed})]})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,n.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Service Type Distribution"}),(0,n.jsx)("div",{className:"space-y-4",children:Object.entries(_.byServiceType).map(e=>{let[s,t]=e;return(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-500 capitalize",children:s}),(0,n.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:t})]},s)})})]})}),(0,n.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("label",{htmlFor:"status-filter",className:"block text-sm font-medium text-gray-700",children:"Filter by Status:"}),(0,n.jsxs)("select",{id:"status-filter",value:u,onChange:e=>h(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"all",children:"All Requests"}),(0,n.jsx)("option",{value:"pending",children:"Pending"}),(0,n.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,n.jsx)("option",{value:"completed",children:"Completed"}),(0,n.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})}),(0,n.jsx)("div",{className:"space-y-6",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-300 text-xs sm:text-sm",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:"Request ID"}),(0,n.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Service Type"}),(0,n.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Preferred Date"}),(0,n.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Status"}),(0,n.jsx)("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6",children:(0,n.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:A.map(e=>{var s;return(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsxs)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:["#",e._id.slice(-6)]}),(0,n.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.serviceType}),(0,n.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:new Date(e.preferredDate).toLocaleDateString()}),(0,n.jsx)("td",{className:"px-3 py-4 text-sm align-middle min-w-[120px] w-full",children:(0,n.jsxs)("div",{className:"relative inline-block",ref:s=>j.current[e._id]=s,children:[(0,n.jsx)("button",{type:"button",disabled:y[e._id],className:"rounded-2xl px-4 py-1 text-xs font-medium flex items-center justify-center focus:outline-none border border-gray-300 transition-all min-w-[120px] ".concat(L(e.status)," ").concat(y[e._id]?"opacity-50 cursor-not-allowed":""),onClick:()=>f(b===e._id?null:e._id),children:y[e._id]?(0,n.jsx)("svg",{className:"animate-spin w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):N[e._id]?(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,n.jsx)("span",{className:"ml-1 text-xs text-green-600",children:"Updated"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"w-full text-center",children:(null===(s=i.find(s=>s.value===e.status))||void 0===s?void 0:s.label)||e.status}),(0,n.jsx)("svg",{className:"ml-2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),b===e._id&&!y[e._id]&&(0,n.jsx)("div",{className:"absolute left-0 mt-2 z-50 bg-white shadow-xl rounded-xl py-2 px-2 min-w-[400px] w-max border border-gray-200 max-h-60 overflow-y-auto",children:(0,n.jsx)("div",{className:"flex flex-row gap-2",children:i.map((s,t)=>{const l=e.status===s.value;return(0,n.jsxs)("div",{className:"cursor-pointer flex items-center justify-center rounded-full px-2 py-1 text-xs font-medium transition-all ".concat(L(s.value),"\n                                      ").concat(l?"ring-2 ring-blue-500 border border-blue-400 bg-opacity-90":"","\n                                      hover:ring-2 hover:ring-blue-300 hover:bg-opacity-80"),style:{minWidth:0},onClick:()=>{f(null),l||C(e._id,s.value)},children:[(0,n.jsx)("span",{className:"w-full text-center",children:s.label}),l&&(0,n.jsx)("svg",{className:"ml-1 w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})]},s.value)})})})]})}),(0,n.jsxs)("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:[(0,n.jsx)("button",{onClick:()=>{x(e),g(!0)},className:"text-blue-600 hover:text-blue-900 mr-4",children:"View Details"}),(0,n.jsx)("button",{onClick:()=>S(e._id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e._id)})})]})})})]}),p&&m&&(0,n.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,n.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-2 sm:px-4 pb-20 text-center sm:block sm:p-0",children:[(0,n.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,n.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,n.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,n.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all w-full max-w-full sm:max-w-lg",children:[(0,n.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,n.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[(0,n.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Request Details"}),(0,n.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Service Type"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:m.serviceType})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Preferred Schedule"}),(0,n.jsxs)("p",{className:"mt-1 text-sm text-gray-900",children:[new Date(m.preferredDate).toLocaleDateString()," - ",m.preferredTime]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Contact Information"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:m.contactNumber})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Description"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:m.description})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Status"}),(0,n.jsxs)("select",{value:m.status,onChange:e=>{C(m._id,e.target.value),x((0,l.A)((0,l.A)({},m),{},{status:e.target.value}))},className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md max-w-[120px] sm:max-w-[160px] truncate whitespace-nowrap",children:[(0,n.jsx)("option",{value:"pending",className:"bg-yellow-100 text-yellow-800",children:"Pending"}),(0,n.jsx)("option",{value:"in-progress",className:"bg-blue-100 text-blue-800",children:"In Progress"}),(0,n.jsx)("option",{value:"completed",className:"bg-green-100 text-green-800",children:"Completed"}),(0,n.jsx)("option",{value:"cancelled",className:"bg-red-100 text-red-800",children:"Cancelled"})]})]})]})]})}),(0,n.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:(0,n.jsx)("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{g(!1),x(null)},children:"Close"})})]})]})})]})})}}]);
//# sourceMappingURL=416.559ddc5e.chunk.js.map